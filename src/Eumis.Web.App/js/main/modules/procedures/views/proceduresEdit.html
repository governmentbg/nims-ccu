<ng-form name="editProcedureDataForm" sc-validate="{}" sc-form-readonly="!editMode">
  <div class="panel panel-default">
    <div class="panel-heading clearfix">
      <strong class="heading" l10n-text="procedures_editProcedureData_title"></strong>

      <div class="pull-right">

        <sc-button name="draftBtn" btn-click="changeStatus('draft')" ng-show="procedure.procedureStatus !== 'draft' && !editMode" text="procedures_editProcedureData_draft" class="btn btn-success btn-xs"
          ng-disabled="!$canDo('ProcedureActions.SetDraft', procedure.procedureId)"></sc-button>

        <sc-button name="enteredBtn" btn-click="changeStatus('entered')" ng-show="procedure.procedureStatus === 'draft' && !editMode" text="procedures_editProcedureData_entered" class="btn btn-default btn-xs"
          ng-disabled="!$canDo('ProcedureActions.SetEntered', procedure.procedureId)"></sc-button>

        <sc-button name="checkedBtn" btn-click="changeStatus('checked')" ng-show="procedure.procedureStatus === 'entered' && !editMode" text="procedures_editProcedureData_checked" class="btn btn-default btn-xs"
          ng-disabled="!$canDo('ProcedureActions.SetChecked', procedure.procedureId)"></sc-button>

        <sc-button name="activeBtn" btn-click="changeStatus('active')" ng-show="procedure.procedureStatus === 'checked' && !editMode" text="procedures_editProcedureData_active" class="btn btn-default btn-xs"
          ng-disabled="!$canDo('ProcedureActions.SetActive', procedure.procedureId)"></sc-button>

        <sc-button name="endedBtn" btn-click="changeStatus('ended')" ng-show="procedure.procedureStatus === 'active' && !editMode" text="procedures_editProcedureData_ended" class="btn btn-default btn-xs"
          ng-disabled="!$canDo('ProcedureActions.SetEnded', procedure.procedureId)"></sc-button>

        <sc-button name="terminatedBtn" btn-click="changeStatus('terminated')" ng-show="procedure.procedureStatus === 'active' && !editMode" text="procedures_editProcedureData_terminated" class="btn btn-default btn-xs"
          ng-disabled="!$canDo('ProcedureActions.SetTerminated', procedure.procedureId)"></sc-button>

        <sc-button name="canceledBtn" btn-click="changeStatus('canceled')" ng-show="procedure.procedureStatus !== 'canceled' && !editMode" text="procedures_editProcedureData_canceled" class="btn btn-danger btn-xs"
          ng-disabled="!$canDo('ProcedureActions.SetCanceled', procedure.procedureId)"></sc-button>

        <sc-button name="editBtn" btn-click="edit()" text="procedures_editProcedureData_edit" class="btn btn-primary btn-xs" icon="glyphicon-edit" ng-show="!editMode && procedure.procedureStatus === 'draft'"
          ng-disabled="!$canDo('ProcedureActions.Edit', procedure.procedureId)"></sc-button>

        <sc-button name="saveBtn" btn-click="save()" text="procedures_editProcedureData_save" class="btn btn-primary btn-xs" icon="glyphicon-floppy-disk" ng-show="editMode">
        </sc-button>
        <sc-button name="cancelBtn" btn-click="cancel()" text="procedures_editProcedureData_cancel" class="btn btn-default btn-xs" icon="glyphicon-ban-circle" ng-show="editMode">
        </sc-button>
      </div>
    </div>

    <div class="panel-body">

      <eumis-procedure-data name="procedureDataForm" ng-model="procedure"></eumis-procedure-data>

      <h5 class="form-header" l10n-text="procedures_editProcedureData_locationTitle"></h5>
      <sc-button name="newProcedureLocationBtn" btn-sref="{ state: 'root.procedures.view.procedureLocation.new' }" text="procedures_editProcedureData_location_new" class="btn btn-sm btn-primary pull-left" icon="glyphicon-plus"
                 ng-disabled="!$canDo('ProcedureActions.Edit', procedure.procedureId) || !editMode"></sc-button>
      
      <sc-datatable items="procedureLocations" filterable="false" pageable="false" sortable="false" dynamic-columns="false" default-sort="type">
        <sc-column sortable="false" class="buttons-cell" has-content="true">
          <sc-button name="editBtn" btn-sref="{ state: 'root.procedures.view.procedureLocation.edit', params: {ind: item.procedureLocationId} }" class="btn btn-xs btn-primary" icon="glyphicon-pencil" ng-disabled="!$canDo('ProcedureActions.Edit', procedure.procedureId) || !editMode"></sc-button>
        </sc-column>
        <sc-column data="nutsLevel" title="procedures_editProcedureData_locationNutsLevel">
        </sc-column>
        <sc-column data="fullPath" title="procedures_editProcedureData_locationFullPath">
        </sc-column>
      </sc-datatable>
    </div>
  </div>
</ng-form>
